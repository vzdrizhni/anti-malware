# frozen_string_literal: true

class ProfilesController < ApplicationController
  def update
    profile = @user.profile.update(profile_params)

    profile_serializer = parse_json profile

    render json: { success: 'hz', data: profile_serializer }
  end

  def create
    return update unless @user.profile.nil?

    profile = @user.create_profile(profile_params)

    if profile.valid?
      profile_serializer = parse_json profile
      render json: { status: :ok, data: profile_serializer }
    else
      render json: { status: 404, message: profile.errors.full_messages }
    end
  end

  private

  def profile_params
    params.permit(:first_name, :last_name, :patronymic, :birthday, :charachteristics)
  end
end
